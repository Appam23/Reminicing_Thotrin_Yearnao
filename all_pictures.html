<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picnic Pictures</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #fbeec1 0%, #a7c7e7 100%);
            margin: 0;
            padding: 0;
        }
        h1 {
            color: #6b4226;
            text-align: center;
            margin-top: 32px;
            margin-bottom: 24px;
            text-shadow: 1px 2px 8px #fff6e0;
        }
        .gallery {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 18px;
            padding: 24px;
        }
        .img-container {
            position: relative;
            display: inline-block;
            width: 220px;
            margin-bottom: 12px;
        }
        .gallery img {
            width: 100%;
            max-width: 220px;
            height: 160px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 2px 8px #e2c79988;
            transition: transform 0.35s cubic-bezier(.4,2,.6,1), box-shadow 0.2s;
            cursor: pointer;
            display: block;
        }
        .gallery img:hover {
            transform: scale(1.15);
            z-index: 2;
            box-shadow: 0 8px 32px #e2c799cc;
        }
        @media (max-width: 600px) {
            .gallery {
                gap: 8px;
                padding: 8px;
            }
            .img-container {
                width: 48vw;
                max-width: 180px;
            }
            .gallery img {
                height: 24vw;
                max-height: 140px;
            }
            h1 {
                font-size: 1.3rem;
                margin-top: 18px;
                margin-bottom: 12px;
            }
            button {
                font-size: 0.95rem;
                padding: 8px 16px;
            }
        }
    </style>
</head>
<body>
    <button onclick="window.location.href='thotrin.html'" style="display:block;margin:24px auto 0 auto;padding:10px 24px;background:#b68973;color:#fffbe6;border:none;border-radius:8px;font-size:1rem;cursor:pointer;box-shadow:0 2px 8px #e2c79988;transition:background 0.2s,box-shadow 0.2s;">Back to Home</button>
    <div style="text-align:center; margin:18px 0;">
        <input type="file" id="uploadInput" accept="image/*" multiple style="display:none;">
        <button onclick="document.getElementById('uploadInput').click();" style="padding:10px 24px;background:#0984e3;color:#fff;border:none;border-radius:8px;font-size:1rem;cursor:pointer;box-shadow:0 2px 8px #a7c7e7;transition:background 0.2s,box-shadow 0.2s;">Upload Pictures</button>
    </div>
    <h1>Picnic Pictures</h1>
    <div class="gallery" id="gallery">
        <!-- Images will be loaded here dynamically -->
    </div>
<script>
// List of static images
const staticImages = [
    { src: 'picnic_pics/img.jpg', alt: 'Picnic 1' },
    { src: 'picnic_pics/img1.jpg', alt: 'Picnic 2' },
    { src: 'picnic_pics/img2.jpg', alt: 'Picnic 3' },
    { src: 'picnic_pics/img3.jpg', alt: 'Picnic 4' },
    { src: 'picnic_pics/img4.jpg', alt: 'Picnic 5' },
    { src: 'picnic_pics/img5.jpg', alt: 'Picnic 6' },
    { src: 'picnic_pics/img6.jpg', alt: 'Picnic 7' },
    { src: 'picnic_pics/img7.jpg', alt: 'Picnic 8' },
    { src: 'picnic_pics/img8.jpg', alt: 'Picnic 9' },
    { src: 'picnic_pics/img9.jpg', alt: 'Picnic 10' },
    { src: 'picnic_pics/img10.jpg', alt: 'Picnic 11' },
    { src: 'picnic_pics/img11.jpg', alt: 'Picnic 12' },
    { src: 'picnic_pics/img12.jpg', alt: 'Picnic 13' },
    { src: 'picnic_pics/img13.jpg', alt: 'Picnic 14' },
    { src: 'picnic_pics/img14.jpg', alt: 'Picnic 15' },
    { src: 'picnic_pics/img15.jpg', alt: 'Picnic 16' }
];

// Render all images (static and backend)
async function renderGallery() {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';
    // Render static images (no delete)
    staticImages.forEach(imgObj => {
        const container = document.createElement('div');
        container.className = 'img-container';
        const img = document.createElement('img');
        img.src = imgObj.src;
        img.alt = imgObj.alt;
        img.addEventListener('click', enlargeImage);
        container.appendChild(img);
        gallery.appendChild(container);
    });
    // Render backend images
    try {
        const res = await fetch('http://localhost:3001/images');
        const images = await res.json();
        images.forEach(imgObj => {
            const container = document.createElement('div');
            container.className = 'img-container';
            const img = document.createElement('img');
            img.src = 'http://localhost:3001' + imgObj.url;
            img.alt = imgObj.filename;
            img.addEventListener('click', enlargeImage);
            // Add delete button for uploaded images
            const delBtn = document.createElement('button');
            delBtn.className = 'delete-btn';
            delBtn.title = 'Delete';
            delBtn.innerHTML = '&times;';
            delBtn.style.position = 'absolute';
            delBtn.style.top = '8px';
            delBtn.style.right = '8px';
            delBtn.style.background = 'rgba(220,53,69,0.85)';
            delBtn.style.color = '#fff';
            delBtn.style.border = 'none';
            delBtn.style.borderRadius = '50%';
            delBtn.style.width = '28px';
            delBtn.style.height = '28px';
            delBtn.style.fontSize = '1.2rem';
            delBtn.style.cursor = 'pointer';
            delBtn.style.zIndex = '2';
            delBtn.style.display = 'none';
            container.addEventListener('mouseenter', () => { delBtn.style.display = 'block'; });
            container.addEventListener('mouseleave', () => { delBtn.style.display = 'none'; });
            delBtn.addEventListener('click', async function(ev) {
                ev.stopPropagation();
                if (confirm('Delete this image?')) {
                    await fetch('http://localhost:3001/images/' + encodeURIComponent(imgObj.filename), { method: 'DELETE' });
                    await renderGallery();
                }
            });
            container.appendChild(img);
            container.appendChild(delBtn);
            gallery.appendChild(container);
        });
    } catch (err) {
        gallery.innerHTML += '<p style="color:red">Failed to load images.</p>';
    }
}

// Upload handler
document.getElementById('uploadInput').addEventListener('change', async function(event) {
    const files = event.target.files;
    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const formData = new FormData();
        formData.append('image', file);
        try {
            const res = await fetch('http://localhost:3001/upload', {
                method: 'POST',
                body: formData
            });
            if (res.ok) {
                await renderGallery();
            } else {
                alert('Upload failed.');
            }
        } catch (err) {
            alert('Upload error.');
        }
    }
    event.target.value = '';
});

// Enlarge image in modal
function enlargeImage(event) {
    const modal = document.getElementById('imgModal');
    const modalImg = document.getElementById('modalImg');
    modalImg.src = this.src;
    modal.classList.add('active');
}

// Attach enlarge event to all images (handled in renderGallery)

// Close modal when clicking outside image or on close button
function closeModal(event) {
    if (event.target.id === 'imgModal' || event.target.id === 'modalCloseBtn') {
        document.getElementById('imgModal').classList.remove('active');
        document.getElementById('modalImg').src = '';
    }
}
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
    renderGallery();
});
</script>
    <!-- Modal for enlarged image -->
    <div class="modal" id="imgModal" onclick="closeModal(event)">
        <button class="modal-close" id="modalCloseBtn" title="Close">&times;</button>
        <img id="modalImg" src="" alt="Enlarged Image">
    </div>
    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
        }
        .modal.active {
            display: flex;
        }
        .modal img {
            max-width: 90vw;
            max-height: 80vh;
            border-radius: 12px;
            box-shadow: 0 4px 32px #000a;
            background: #fff;
        }
        .modal-close {
            position: absolute;
            top: 32px;
            right: 48px;
            font-size: 2.5rem;
            color: #fffbe6;
            background: none;
            border: none;
            cursor: pointer;
            z-index: 1001;
        }
    </style>
</style>
<script>
// Enlarge image in modal
function enlargeImage(event) {
    const modal = document.getElementById('imgModal');
    const modalImg = document.getElementById('modalImg');
    modalImg.src = this.src;
    modal.classList.add('active');
}

// Attach enlarge event to all images
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.gallery img').forEach(img => {
        img.addEventListener('click', enlargeImage);
    });
});

// Close modal when clicking outside image or on close button
function closeModal(event) {
    if (event.target.id === 'imgModal' || event.target.id === 'modalCloseBtn') {
        document.getElementById('imgModal').classList.remove('active');
        document.getElementById('modalImg').src = '';
    }
}
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
});
</script>
</html>
